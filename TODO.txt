Сделать
check_sntp
check_arp_table
check_route_table
для DGS3100

Завести класс для RouterOS с RouterOS api

Вносить данные в SQL

Сделать многопоточное сканирование по подсетям

Переделать сканирование сервисов, чтобы происходило параллельно